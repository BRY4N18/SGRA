<section class="page-header">
  <div>
    <h2><span class="header-icon">üïò</span> Gesti√≥n de Disponibilidad</h2>
    <p>Define tus horarios disponibles para sesiones de refuerzo acad√©mico.</p>
  </div>
  <div class="header-actions">
    <button class="btn btn-outline-secondary btn-sm" type="button" (click)="clearAll()">Limpiar todo</button>
    <button class="btn btn-success btn-sm" type="button" (click)="saveChanges()">Guardar cambios</button>
  </div>
</section>

<section class="info-card">
  <div class="info-icon">‚ÑπÔ∏è</div>
  <div>
    <strong>Instrucciones:</strong> Haz clic en las celdas para marcar o desmarcar tu disponibilidad.
    Los horarios marcados en verde estar√°n disponibles para que los estudiantes soliciten sesiones de refuerzo.
    <div class="info-note">Los horarios ya reservados para sesiones aparecen en color morado y no pueden modificarse.</div>
  </div>
</section>

<section class="legend-card">
  <span class="legend-item"><span class="legend-chip available"></span> Disponible</span>
  <span class="legend-item"><span class="legend-chip busy"></span> No disponible</span>
  <span class="legend-item"><span class="legend-chip session"></span> Sesi√≥n programada</span>
</section>

<section class="controls-card">
  <div class="control-group">
    <span class="control-label">Selecci√≥n r√°pida por d√≠a:</span>
    <div class="day-buttons">
      <button
        class="day-button"
        type="button"
        *ngFor="let day of quickDays"
        [class.active]="selectedDay === day"
        (click)="selectDay(day)"
      >
        {{ day }}
      </button>
    </div>
  </div>
  <div class="control-group">
    <span class="control-label">Selecci√≥n por bloque horario:</span>
    <select class="block-select" [value]="selectedBlock" (change)="selectBlock($event)">
      <option *ngFor="let option of blockOptions" [value]="option">{{ option }}</option>
    </select>
  </div>
</section>

<section class="availability-card">
  <div class="availability-grid">
    <div class="grid-header">
      <div class="time-cell"></div>
      <div class="day-cell" *ngFor="let day of days">
        <span class="day-name">{{ day }}</span>
        <small>{{ getDaySlots(day) }} slots</small>
      </div>
    </div>
    <div class="grid-row" *ngFor="let time of times">
      <div class="time-cell">
        <strong>{{ time }}</strong>
        <small>{{ getEndTime(time) }}</small>
      </div>
      <button
        class="slot"
        type="button"
        *ngFor="let day of days"
        [ngClass]="getStatusClass(day, time)"
        (click)="toggleSlot(getSlot(day, time))"
      >
        <span class="slot-icon" *ngIf="getSlotStatus(day, time) === 'DISPONIBLE'">‚úì</span>
        <span class="slot-icon" *ngIf="getSlotStatus(day, time) === 'SESION'">‚úï</span>
      </button>
    </div>
  </div>
</section>

<div *ngIf="feedback" class="toast" [class.toast-success]="feedbackType === 'success'">
  {{ feedback }}
</div>

<section class="summary-card">
  <div class="summary-header">
    <span class="summary-icon">üìã</span>
    <h4>Resumen de Disponibilidad</h4>
  </div>
  <div class="summary-metrics">
    <div class="summary-item">
      <span class="summary-value">{{ stats.disponibles }}</span>
      <span class="summary-label">Slots disponibles</span>
    </div>
    <div class="summary-item">
      <span class="summary-value">{{ stats.programadas }}</span>
      <span class="summary-label">Sesiones programadas</span>
    </div>
    <div class="summary-item">
      <span class="summary-value">{{ stats.horasSemanales }}</span>
      <span class="summary-label">Horas semanales</span>
    </div>
    <div class="summary-item">
      <span class="summary-value">{{ stats.diasActivos }}</span>
      <span class="summary-label">D√≠as con disponibilidad</span>
    </div>
  </div>
  <div class="distribution">
    <h5>Distribuci√≥n semanal</h5>
    <div class="bar" *ngFor="let item of stats.distribucion">
      <span>{{ item.day }}</span>
      <div class="bar-track">
        <div class="bar-fill" [style.width.%]="item.hours * 14"></div>
      </div>
      <strong>{{ item.hours }}</strong>
    </div>
  </div>
</section>
